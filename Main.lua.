-- White Cat Hub Final (All-in-One: Fly + Auto Eat + Rescue + Auto Rescue + TP + ESP + Auto Chop + Key)
local CoreGui, Players, RunService, UserInputService, TweenService = game:GetService("CoreGui"), game:GetService("Players"), game:GetService("RunService"), game:GetService("UserInputService"), game:GetService("TweenService")
local lplayer = Players.LocalPlayer
local correctKey = "Kikicatwalk"
local fileName = "WhiteCatKey.txt"

-- Cleanup & Sounds
if CoreGui:FindFirstChild("WhiteCatHub") then CoreGui.WhiteCatHub:Destroy() end
local sg = Instance.new("ScreenGui", CoreGui); sg.Name = "WhiteCatHub"
local meow = Instance.new("Sound", sg); meow.SoundId = "rbxassetid://5104257032"; meow.Volume = 1

local function bounce(obj)
    local oldSize = obj.Size
    obj:TweenSize(UDim2.new(oldSize.X.Scale * 0.85, oldSize.X.Offset, oldSize.Y.Scale * 0.85, oldSize.Y.Offset), "Out", "Quad", 0.1, true)
    task.wait(0.1)
    obj:TweenSize(oldSize, "Out", "Back", 0.1, true)
end

-- Main UI
local main = Instance.new("Frame", sg)
main.Size = UDim2.new(0, 320, 0, 420); main.Position = UDim2.new(0.5, -160, 0.3, 0)
main.BackgroundColor3 = Color3.new(1, 1, 1); main.Visible = false; main.Active = true; main.Draggable = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 15)

local toggleBtn = Instance.new("TextButton", sg)
toggleBtn.Size = UDim2.new(0, 50, 0, 50); toggleBtn.Position = UDim2.new(0, 20, 0.5, 0)
toggleBtn.Text = "CAT"; toggleBtn.BackgroundColor3 = Color3.new(1, 1, 1); toggleBtn.Visible = false
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1, 0)
toggleBtn.MouseButton1Click:Connect(function() meow:Play(); bounce(toggleBtn); main.Visible = not main.Visible end)

-- Tabs
local tabContainer = Instance.new("Frame", main)
tabContainer.Size = UDim2.new(1, 0, 0, 35); tabContainer.Position = UDim2.new(0, 0, 0, 45); tabContainer.BackgroundTransparency = 1
local tabLayout = Instance.new("UIListLayout", tabContainer); tabLayout.FillDirection = "Horizontal"; tabLayout.HorizontalAlignment = "Center"; tabLayout.Padding = UDim.new(0, 2)

local pages = {}
local function CreateTab(name, active)
    local btn = Instance.new("TextButton", tabContainer); btn.Size = UDim2.new(0, 50, 0, 25); btn.Text = name; btn.BackgroundColor3 = active and Color3.fromRGB(255, 182, 193) or Color3.fromRGB(240, 240, 240); btn.Font = "GothamBold"; btn.TextSize = 9; Instance.new("UICorner", btn)
    local pg = Instance.new("ScrollingFrame", main); pg.Size = UDim2.new(1, -20, 1, -110); pg.Position = UDim2.new(0, 10, 0, 85); pg.Visible = active or false; pg.BackgroundTransparency = 1; pg.ScrollBarThickness = 0
    Instance.new("UIListLayout", pg).Padding = UDim.new(0, 5)
    pages[name] = {page = pg, button = btn}
    btn.MouseButton1Click:Connect(function()
        for _, p in pairs(pages) do p.page.Visible = false; p.button.BackgroundColor3 = Color3.fromRGB(240, 240, 240) end
        pg.Visible = true; btn.BackgroundColor3 = Color3.fromRGB(255, 182, 193); bounce(btn)
    end)
    return pg
end

local function AddBtn(pg, txt, cb)
    local b = Instance.new("TextButton", pg); b.Size = UDim2.new(1, 0, 0, 30); b.Text = txt; b.BackgroundColor3 = Color3.fromRGB(245, 245, 245); b.Font = "Gotham"; b.TextSize = 11; Instance.new("UICorner", b)
    b.MouseButton1Click:Connect(function() meow:Play(); bounce(b); cb() end)
end

local mainPg = CreateTab("Main", true)
local espPg = CreateTab("ESP")
local tpPg = CreateTab("TP")
local miscPg = CreateTab("Misc")

-- --- FLY ---
local flying = false
AddBtn(miscPg, "Toggle Fly", function()
    flying = not flying
    if flying then
        local bv = Instance.new("BodyVelocity", lplayer.Character.HumanoidRootPart)
        bv.Name = "CatFly"; bv.MaxForce = Vector3.new(9e9, 9e9, 9e9); bv.Velocity = Vector3.new(0,0,0)
        local bg = Instance.new("BodyGyro", lplayer.Character.HumanoidRootPart)
        bg.Name = "CatGyro"; bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9); bg.P = 9e4
        task.spawn(function()
            while flying do
                bv.Velocity = workspace.CurrentCamera.CFrame.LookVector * 60
                bg.CFrame = workspace.CurrentCamera.CFrame
                task.wait()
            end
            bv:Destroy(); bg:Destroy()
        end)
    end
end)

-- --- AUTO EAT ---
local autoEat = false
AddBtn(mainPg, "Toggle Auto Eat", function()
    autoEat = not autoEat
    task.spawn(function()
        while autoEat do
            local hunger = lplayer:FindFirstChild("Hunger", true) or lplayer.Character:GetAttribute("Hunger")
            if hunger and (hunger.Value or hunger) < 70 then
                local food = lplayer.Backpack:FindFirstChild("Berry") or lplayer.Backpack:FindFirstChild("Meat") or lplayer.Backpack:FindFirstChild("Apple") or lplayer.Backpack:FindFirstChild("Cooked Meat")
                if food then
                    food.Parent = lplayer.Character; food:Activate(); task.wait(0.5); food.Parent = lplayer.Backpack
                end
            end
            task.wait(2)
        end
    end)
end)

-- --- RESCUE ---
AddBtn(mainPg, "Rescue All Kids", function()
    local kids = {"Dino Kid", "Kraken Kid", "Squid Kid", "Koala Kid"}
    for _, k in pairs(kids) do
        local kid = workspace:FindFirstChild(k, true)
        if kid and lplayer.Character then
            lplayer.Character.HumanoidRootPart.CFrame = kid:GetModelCFrame() or kid.CFrame
            task.wait(0.6)
            local r = kid:FindFirstChild("HumanoidRootPart") or kid:FindFirstChildWhichIsA("BasePart")
            if r then r.CFrame = lplayer.Character.HumanoidRootPart.CFrame end
        end
    end
end)

-- --- TP ---
AddBtn(tpPg, "TP Campfire", function() 
    local t = workspace:FindFirstChild("Campfire", true)
    if t then lplayer.Character.HumanoidRootPart.CFrame = t:GetModelCFrame() or t.CFrame end
end)

-- --- AUTO RESCUE ---
local autoRescue = false
AddBtn(tpPg, "Toggle Auto Rescue", function()
    autoRescue = not autoRescue
    task.spawn(function()
        while autoRescue do
            if lplayer.Character and lplayer.Character:FindFirstChild("HumanoidRootPart") then
                local kids = {"Dino Kid", "Kraken Kid", "Squid Kid", "Koala Kid"}
                for _, kidName in pairs(kids) do
                    local kid = workspace:FindFirstChild(kidName, true)
                    if kid then
                        local kidPart = kid:FindFirstChild("HumanoidRootPart") or kid:FindFirstChildWhichIsA("BasePart")
                        if kidPart then
                            lplayer.Character.HumanoidRootPart.CFrame = kidPart.CFrame + Vector3.new(0,3,0)
                            task.wait(0.5)
                            kidPart.CFrame = lplayer.Character.HumanoidRootPart.CFrame + Vector3.new(0,-2,0)
                        end
                    end
                end
            end
            task.wait(1)
        end
    end)
end)

-- --- MISC ---
AddBtn(miscPg, "2x Speed & Inf Stamina", function()
    lplayer.Character.Humanoid.WalkSpeed = 32
    _G.stam = true; task.spawn(function() while _G.stam do local s = lplayer.Character:FindFirstChild("Stamina", true) if s then s.Value = 100 end task.wait(0.5) end end)
end)

-- --- ESP FOR ANIMALS + Chests ---
local espEnabled = false
local espObjects = {}
AddBtn(espPg, "Toggle ESP (Animals + Chests)", function()
    espEnabled = not espEnabled
    if not espEnabled then
        for _, data in pairs(espObjects) do
            if data.Highlight then data.Highlight:Destroy() end
            if data.Label then data.Label:Destroy() end
        end
        espObjects = {}
        return
    end

    task.spawn(function()
        while espEnabled do
            local animals = {"Bear", "Wolf", "Fox", "Deer", "Boar"}
            local chests = {"Chest", "TreasureChest"}

            for _, objName in pairs(animals) do
                local obj = workspace:FindFirstChild(objName, true)
                if obj and obj:FindFirstChildWhichIsA("BasePart") then
                    local part = obj:FindFirstChildWhichIsA("BasePart")
                    if not espObjects[obj] then
                        local hl = Instance.new("Highlight")
                        hl.Adornee = obj
                        hl.FillColor = Color3.fromRGB(255,0,0)
                        hl.FillTransparency = 0.7
                        hl.OutlineColor = Color3.fromRGB(255,255,255)
                        hl.OutlineTransparency = 0
                        hl.Parent = obj

                        local bg = Instance.new("BillboardGui")
                        bg.Adornee = part
                        bg.Size = UDim2.new(0,120,0,40)
                        bg.AlwaysOnTop = true
                        bg.StudsOffset = Vector3.new(0,3,0)
                        bg.Parent = obj

                        local label = Instance.new("TextLabel")
                        label.Size = UDim2.new(1,0,1,0)
                        label.BackgroundTransparency = 1
                        label.TextColor3 = Color3.fromRGB(255,255,255)
                        label.TextScaled = true
                        label.Font = Enum.Font.GothamBold
                        label.Parent = bg

                        espObjects[obj] = {Highlight=hl, Label=label, Billboard=bg}
                    end
                    local dist = math.floor((lplayer.Character.HumanoidRootPart.Position - part.Position).Magnitude)
                    espObjects[obj].Label.Text = objName.." — "..dist.."m"
                end
            end

            for _, objName in pairs(chests) do
                local obj = workspace:FindFirstChild(objName, true)
                if obj and obj:FindFirstChildWhichIsA("BasePart") then
                    local part = obj:FindFirstChildWhichIsA("BasePart")
                    if not espObjects[obj] then
                        local hl = Instance.new("Highlight")
                        hl.Adornee = obj
                        hl.FillColor = Color3.fromRGB(0,255,0)
                        hl.FillTransparency = 0.7
                        hl.OutlineColor = Color3.fromRGB(255,255,255)
                        hl.OutlineTransparency = 0
                        hl.Parent = obj

                        local bg = Instance.new("BillboardGui")
                        bg.Adornee = part
                        bg.Size = UDim2.new(0,120,0,40)
                        bg.AlwaysOnTop = true
                        bg.StudsOffset = Vector3.new(0,3,0)
                        bg.Parent = obj

                        local label = Instance.new("TextLabel")
                        label.Size = UDim2.new(1,0,1,0)
                        label.BackgroundTransparency = 1
                        label.TextColor3 = Color3.fromRGB(0,255,0)
                        label.TextScaled = true
                        label.Font = Enum.Font.GothamBold
                        label.Parent = bg

                        espObjects[obj] = {Highlight=hl, Label=label, Billboard=bg}
                    end
                    local dist = math.floor((lplayer.Character.HumanoidRootPart.Position - part.Position).Magnitude)
                    espObjects[obj].Label.Text = objName.." — "..dist.."m"
                end
            end

            task.wait(0.5)
        end
    end)
end)

-- --- AUTO CHOP TREES ---
local autoChop = false
AddBtn(miscPg, "Toggle Auto Chop Trees", function()
    autoChop = not autoChop
    task.spawn(function()
        while autoChop do
            if lplayer.Character and lplayer.Backpack:FindFirstChild("Axe") then
                local axe = lplayer.Backpack:FindFirstChild("Axe")
                local trees = workspace:GetDescendants()
                for _, t in pairs(trees) do
                    if t.Name:match("Tree") and t:IsA("BasePart") then
                        axe.Parent = lplayer.Character
                        lplayer.Character.HumanoidRootPart.CFrame = t.CFrame + Vector3.new(0,3,0)
                        axe:Activate()
                        task.wait(0.5)
                        axe.Parent = lplayer.Backpack
                    end
                end
            end
            task.wait(1)
        end
    end)
end)

-- Key System
local function Unlock() meow:Play(); if sg:FindFirstChild("KeyFrame") then sg.KeyFrame:Destroy() end; toggleBtn.Visible = true; main.Visible = true; if writefile then writefile(fileName, correctKey) end end
if not (isfile and isfile(fileName) and readfile(fileName) == correctKey) then
    local kf = Instance.new("Frame", sg); kf.Name = "KeyFrame"; kf.Size = UDim2.new(0, 250, 0, 160); kf.Position = UDim2.new(0.5, -125, 0.4, 0); kf.BackgroundColor3 = Color3.fromRGB(255, 240, 245); kf.Active = true; kf.Draggable = true; Instance.new("UICorner", kf)
    local ki = Instance.new("TextBox", kf); ki.Size = UDim2.new(0.8, 0, 0, 35); ki.Position = UDim2.new(0.1, 0, 0.3, 0); ki.PlaceholderText = "Key..."; Instance.new("UICorner", ki)
    local kb = Instance.new("TextButton", kf); kb.Size = UDim2.new(0.8, 0, 0, 35); kb.Position = UDim2.new(0.1, 0, 0.65, 0); kb.Text = "Unlock Hub"; kb.BackgroundColor3 = Color3.fromRGB(255, 182, 193); Instance.new("UICorner", kb)
    kb.MouseButton1Click:Connect(function() if ki.Text == correctKey then Unlock() end end)
else Unlock() end

-- Credits
local credits = Instance.new("TextLabel", main); credits.Size = UDim2.new(1, 0, 0, 20); credits.Position = UDim2.new(0, 0, 1, -20); credits.Text = "maded by : kiki"; credits.TextColor3 = Color3.fromRGB(255, 182, 193); credits.BackgroundTransparency = 1
